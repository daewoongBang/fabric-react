(this["webpackJsonpfabric-react"]=this["webpackJsonpfabric-react"]||[]).push([[0],{16:function(e,t){},17:function(e,t){},18:function(e,t){},19:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),a=n(5),r=n.n(a),i=n(3),l=n(2),u=n(1),f=function(){var e=Object(o.useRef)(),t=Object(o.useState)(),n=Object(l.a)(t,2),a=n[0],r=n[1],f=Object(o.useState)([]),b=Object(l.a)(f,2),s=b[0],d=b[1],p=Object(o.useState)(0),j=Object(l.a)(p,2),y=j[0],O=j[1],g=Object(o.useState)([]),m=Object(l.a)(g,2),v=m[0],C=m[1],h=Object(o.useState)([]),k=Object(l.a)(h,2),E=k[0],x=k[1],w=Object(o.useState)(!1),S=Object(l.a)(w,2),P=S[0],A=S[1],B=Object(o.useState)({type:"",background:"",border:""}),M=Object(l.a)(B,2),J=M[0],L=M[1],R=Object(o.useCallback)((function(){var e=G();e&&(e.edit=!e.edit,A(e.edit),e.edit?(e.cornerStyle="circle",e.hasControls=!1,F(e.points)):(e.cornerStyle="rect",e.controls=u.fabric.Object.prototype.controls,v.forEach((function(e){a.remove(e)})),C([])),a.requestRenderAll())}),[a,v]),W=Object(o.useCallback)((function(){A(!1),a.clear()}),[a]),q=Object(o.useCallback)((function(e){if("polygon"===J.type){var t=e.pointer.x,n=e.pointer.y;x(E.concat({x:t,y:n}));var o=[t,n,t,n],c=new u.fabric.Line(o,{strokeWidth:2,selectable:!1,stroke:"rgba(0, 255, 0, 0.5)"});d(s.concat(c)),O(y+1),a.add(c)}}),[a,J,E,s,y]),z=Object(o.useCallback)((function(e){var t=a.getActiveObject();t&&"polygon"===t.get("type")&&t.edit&&v.forEach((function(e){a.remove(e)}))}),[a,v]),D=Object(o.useCallback)((function(e){s[0]&&"polygon"===J.type&&(s[y-1].set({x2:e.pointer.x,y2:e.pointer.y}),a.renderAll())}),[a,J,s,y]),H=Object(o.useCallback)((function(e){if("circle"===e.target.get("type")){var t=G(),n=e.target;t.points[n.name]={x:n.getCenterPoint().x,y:n.getCenterPoint().y}}}),[a]),I=Object(o.useCallback)((function(){if("polygon"===J.type){L(Object(i.a)({},J,{type:""})),s.forEach((function(e){a.remove(e)})),E.splice(E.length-1);var e=Y(E);a.add(e),a.renderAll(),x([]),d([]),O(0)}}),[a,J,s,E]),T=Object(o.useCallback)((function(e){e.target&&window.console.log("target",e.target.get("type"))}),[a]),X=Object(o.useCallback)((function(e){var t=G();if(t){var n=K();t.initialize(n);var o=Y(n);if(o.left=t.left,o.top=t.top,o.edit=t.edit,a.forEachObject((function(e){a.remove(e)})),a.add(o),o.edit){var c=K();F(c)}a.renderAll()}}),[a]),Y=Object(o.useCallback)((function(e){return new u.fabric.Polygon(e,{left:Q(E),top:N(E),fill:"rgba(0, 255, 0, 0.1)",hasBorders:!1,hasControls:!1,objectCaching:!1,selection:!1,index:0})}),[a,E]),F=Object(o.useCallback)((function(e){var t=[];e.forEach((function(e,n){var o=new u.fabric.Circle({radius:5,fill:"rgba(0, 255, 0, 0.8)",left:e.x,top:e.y,originX:"center",originY:"center",hasBorders:!1,hasControls:!1,selection:!1,name:n,index:n,hoverCursor:"pointer"});t=t.concat(o),a.add(o)})),C(t)}),[a]),G=Object(o.useCallback)((function(){var e=null;return a.forEachObject((function(t){"polygon"===t.get("type")&&(e=t)})),e}),[a,v]),K=Object(o.useCallback)((function(){var e=G(),t=e.calcTransformMatrix();return e.get("points").map((function(t){return new u.fabric.Point(t.x-e.pathOffset.x,t.y-e.pathOffset.y)})).map((function(e){return u.fabric.util.transformPoint(e,t)}))}),[a]),N=Object(o.useCallback)((function(e){for(var t=a.height,n=0;n<y;n++)e[n].y<t&&(t=e[n].y);return Math.abs(t)}),[a,y]),Q=Object(o.useCallback)((function(e){for(var t=a.width,n=0;n<y;n++)e[n].x<t&&(t=e[n].x);return Math.abs(t)}),[a,y]);return Object(o.useEffect)((function(){a&&(a.off("mouse:up"),a.off("mouse:down"),a.off("mouse:move"),a.off("mouse:dblclick"),a.off("object:moving"),a.off("object:modified"),a.off("mouse:over"),a.on("mouse:up",q),a.on("mouse:down",z),a.on("mouse:move",D),a.on("mouse:dblclick",I),a.on("object:moving",H),a.on("object:modified",X),a.on("mouse:over",T))}),[a,J,E,s,v,y]),Object(o.useEffect)((function(){if(a)r(a);else{var t=new u.fabric.Canvas(e.current,{selection:!1});t.setWidth(500).setHeight(500).setBackgroundColor("#ffffff").renderAll(),window.console.log("fabricCanvas",t),r(t)}}),[]),c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){a.forEachObject((function(e){a.remove(e)})),"polygon"===J.type?L(Object(i.a)({},J,{type:""})):L(Object(i.a)({},J,{type:"polygon"}))},disabled:""!==J.type||P},"Draw Polygon"),c.a.createElement("button",{onClick:R,disabled:""!==J.type},"Edit Polygon"),c.a.createElement("button",{onClick:W,disabled:""!==J.type},"clear"),c.a.createElement("canvas",{ref:e,style:{border:"1px solid black"}})),c.a.createElement("div",{style:{marginLeft:"10px"}},c.a.createElement("p",null,"drawingObject type : ",J.type),c.a.createElement("p",null,"isEdit : ",P.toString())))};var b=function(){return c.a.createElement(f,null)};r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b,null)),document.getElementById("root"))},6:function(e,t,n){e.exports=n(19)}},[[6,1,2]]]);
//# sourceMappingURL=main.d6b835ea.chunk.js.map